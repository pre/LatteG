<!DOCTYPE html>
<html lang="en">
  <head>
  
    <title>
      Designing a Phishing Resistant OpenID Identity Provider
    </title>

    <meta charset="utf-8" />
    
    <link rel="stylesheet" href="stylesheets/lattex.css">

    <script src="javascripts/lattex.js"></script>

    <script src="hyphenator/Hyphenator.js" type="text/javascript"></script>
    <script type="text/javascript">
      Hyphenator.config({
        displaytogglebox : false,
        minwordlength : 4
      });

    Hyphenator.run();

    </script>


    <script>
      var conf = { 
        lol: true,
        cat: "loooong"
        };
    </script>



  </head>


  <body>

    <header>
      <h1 data-lattex="title"></h1>

      <address>
        Petrus Repo
      </address>

    </header>

    <p>
      <strong>Please note:</strong>
      This document will be formatted to conform with CS Dept's official
      layout as <a href="http://github.com/pre/LatteG">LatteG</a> matures.
    </p>

    <nav>
      <h1>Table of Contents</h1>
      
      <!-- <section style="display: none;">
        
        1 Introduction

        2 Authentication in the Web
          2.1 Concepts of Authentication and Authorization
          2.2 Challenge-Response Authentication
          2.3 Authentication with OpenID

        3 Landscape of Phishing
          3.1 Deceptive Phishing Attacks
          3.2 Lack of Knowledge and Attention
          3.3 Trojan-based Attacks
          3.4 Phishing as a Risk for OpenID

        4 Phishing Resistant Authentication Process
          4.1 Two-factor Authentication
          4.2 Client Certificate as an Authentication Response
          4.3 Combining Benefits of OpenID and Client Certificates

        5 Conclusions
        
      </section> -->
    </nav>


    <p>
      <strong>Please note:</strong>
      This document will be formatted to conform with CS Dept's official
      layout as <a href="http://github.com/pre/LatteG">LatteG</a> matures.
    </p>

    <article>
      <h1 data-lattex="title"></h1>

      <section>
        <h1>Introduction</h1>

        <pre>
          Phishing is a form of online identity theft targeting to steal sensitive information from an end user <cite>phishing_attacks_and_solutions_2007, why_phishing_works_06, suspectibility_to_phishing_2006</cite>. Victims are tricked into providing such information by a combination of spoofing techniques and social engineering <cite>visual_similarity_phishing_2008</cite>. The process usually involves a fraudulent web site imitating a specific authentic site. 

          The goal is to trick the user submitting his secret information to the fraudulent imitation site that could be later used by somebody else to access the authentic service. A common way to lure someone to a fraudulent phishing site is to send the victim an email or instant message that asks him to visit a malicious site. Additionally, if that message appears to come from a friend or a trusted social network, the more effectively it will work [CITE]. The goal is to acquire sensitive information, such as a username and password, by masquerading the malicious site as a particular trustworthy entity.

          Studies of Dhamija et al. <cite>why_phishing_works_06</cite> show that in order for a phishing attempt to be convincing, it must be targeted to a specific system. Since a single sign-on system provides access to multiple services, a successful phishing attempt targeted against the identity provider affects all its identity consumers. Therefore phishing poses a risk that affects especially single sign-on systems. 

          Being an attractive target for phishing might give an impression that single sign-on systems should be avoided for business critical services. One big factor is that by nature any web service is, to some level, vulnerable to phishing <cite>why_phishing_works_06</cite>. Using a central identification provider allows a malicious party to focus his attack on that particular provider. But on the other hand, this also allows the service administrators to focus on the issues on only one particular identity provider. Thus, if identification provider were to be implemented on a per service basis, it would require focusing on phishing issues on each and every one of them.

        </pre>
      </section> <!-- Introduction -->
      

      <section>
        <h1>Authentication in the Web</h1>

        <section>
          <h1>Concepts of Authentication and Authorization</h1>
      
          <pre>
            Authentication is usually considered a synonym for confirming the identity of a requester. In order to apply an access control policy, a requester must first be authenticated. In other words, verifying the identity of a requestor is a preceding step for controlling access to a resource. Claiming an identity, however, does not require trust between the identified requestor and the accessed resource. It barely means that a particular requestor is able to present credentials for a particular identity. The level of trust is defined in access control policy and implemented by an authorization process.

            Granting someone permission to access a requested resource is generally called authorization. An authorization transaction is usually preceded by an authentication process to verify the identity of the requester. When the requester has been identified, the access control process checks that he be authorized to use the targeted resource. It can also be possible to implement an access control policy without actually identifying the requester. A request could, for instance, be authorized by requester's geolocation, an access token or simply by the time of the day.
            
            Lampson et al. define a theory of authentication in distributed systems <cite>lampson_distributed_1992</cite>. They create an abstraction of many special cases to basic concepts of "principal, statement and channel". If <em>s</em> is a statement, for instance a request, then authentication answers the question "Who said <em>s</em>?" with a principal. Likewise, if <em>o</em> is an object, then authorization answers the question "Who is trusted to access <em>o</em>?" with a principal. A simple principal could for example be a person ("Peter"), a machine ("dac-123") or a role ("Teacher"). A compound principal is build up of other principals such as "Peter as Teacher" or "dac-123 as University of Helsinki" correspondingly. 

            Lampson et al. <cite>lampson_distributed_1992</cite> define that a channel is the only kind of a principal that can directly make statements to a computer. For example, there is no direct path from a person to a computer, that is, communication must be over some channel, involving keystrokes, wires, networks <em>et cetera</em>. Naturally some of these channels are not secure. In the scope of this paper we assume the HTTP transport layer be secured with a proper usage of SSL/TLS.

          </pre>
        </section> <!-- Auth & auth -->

        <section>
          <h1>Challenge-Response Authentication</h1>
          <pre>
            Challenge-Response authentication is a family of protocols, where one party presents a question (challenge) for which another party needs to provide a valid answer (response) to be authenticated <cite>wikipedia:Challenge-response_authentication</cite>. A simple example of challenge-response protocol is password authentication where one party asks for a username and password of which the another party needs to provide valid combination. However, if the communication channel may not be trusted, an eavesdropper might learn the response and exploit it.

            Software games of 1990s usually had piracy protection based on presenting a challenge and requiring a valid response for gameplay. Usually the challenge was an arbitrary question and the response could be found on a printed document which was delivered with a legal copy of the game. The motivation was that copying only the game files was not enough, and duplicating a printed document of codes was more difficult than only copying the files.

            Challenges may also involve a publicly known response. For example, the motivation could be restricting the group who may provide a response to only those who know Russian language, are familiar with an inside joke or are human users. A familiar example is a CAPTCHA verification [TODO: kuva!] for preventing spam-robot users. A challenge could be a simple mathematical operation asked in natural language or a number included in a scrambled bitmap image. The motivation is presenting a question which only a human is able to understand, although the actual answer is publicly known.
          </pre>
        
        </section> <!-- challenge-response -->

        <section>
          <h1>User-centric Identity</h1>
        
          <pre>
            Giving full control of identity lifecycle to the customer is a prerequisite for user-centric identity. It allows the customer to decide when and how their identity information can be accessed <cite>open_identity_management_saas_2009</cite>. The term "user-centric identity management" is understood to mean digital identity infrastructure where an individual end-user has substantially independent control over the use of their identifier(s) and personally-identifiable information <cite>openid_2.0_platform_2009</cite>. OpenID specification provides user-centric infrastructure with two overall architectures: an address-based and a card-based identity.

            An address-based identity employs a unique digital address to identify a user. The identification process is based on proving the ownership of a particular address. For example an OpenID identity address may be composed of a URL or an XRI. One of the first steps in the OpenID authentication process is dereferencing the identity address to discover and invoke the associated identity service <cite>openid_2.0_platform_2009</cite>. XRI addresses have lately been deprecated <cite>xri_depcrecated_08a, xri_depcrecated_08b, xri_depcrecated_08c, xri_depcrecated_08d</cite>. Hence, this paper concentrates on URL based identities such as <em>http://user.example.com</em> or <em>http://example.com/user</em>.

            A card-based identity uses a digital token that contains or references a collection of attributes that may individually or collectively identify the user <cite>openid_2.0_platform_2009</cite>. The collection provides the necessary information to accomplish an identity-based transaction. According to Recordon and Reed <cite>openid_2.0_platform_2009</cite> both address- and card-based approaches can be applied individually, but they also can complement each other. As an example an address-based identity could be used to discover a card-based identity, and a card-based identity could contain one or more address-based identities. Card-based identity has not, however, gained much popularity among OpenID enabled services. [CITE: etsi]. It also suffers from problems that are discussed on chapter [#REF: client certs].

          </pre>
        </section>

        <section>
          <h1>Authentication with OpenID</h1>
          <pre>
            OpenID authentication has four actors: the end-user, the relying party (RP) the claimed identifier (ID) and the identity provider (IDP) <cite>openid_2.0_platform_2009</cite>. The relying party is the service which the end user wants to access, and the identity provider is the service whose responsibility is to ensure that a claimed identifier belongs to the user. Authentication flow is illustrated in figure [REF/TODO: openid-flow] and described below.
            
             In order to begin the authentication process, the relying party asks the user for an OpenID identifier (step XX). After the user has submitted his claimed identifier, the relying party initializes a discovery process for finding an identity provider that is associated with it (step XX). When the identity provider has been discovered, the user is redirected to its sign in page. By signing in to the identity provider the user proves the ownership of the OpenID identifier. After signing in successfully, the user is redirected back to the relying party along with a cryptographic proof of the ownership of the claimed identifier. The user is then signed in to the relying party which is the service he originally wanted to access.

             The principle of user-centric identity gives the user a possibility of choosing an identity provider of his own. This is different from the principle federated identity where a trusted third-party guarantees the person behind an identifier. A user-centric identity provider verifies only that only an authenticated user may prove the ownership for an identifier, that is, the person behind of an identifier is not necessarily guaranteed. This does not, however, usually pose a problem because a typical web service wants only to distinguish between different identifiers. Hence, it is enough to guarantee that there is only one owner behind a particular identifier.

          </pre>
        </section>

      </section> <!-- Auth in the Web -->

      <section>
        <h1>Landscape of Phishing</h1>
        
        <pre>
          It is not feasible to produce a comprehensive catalog of phishing methods given both the current sophistication and rapid evolution of phishing attacks <cite>phishing_attacks_and_solutions_2007</cite>. Dhamija <em>et al.</em> <cite>why_phishing_works_06</cite> studied phishing strategies that were organized along three dimensions: visual deception, lack of knowledge, and lack of attention. According to <cite>phishing_attacks_and_solutions_2007, suspectibility_to_phishing_2006</cite> general attack vectors include the following:
        
          <ul>
            <li>Deceptive attacks (spear phishing),
              in which users are tricked by fraudulent messages into giving out
              information; could involve personalized emails or emails sent to a specifically 
              targeted group.
            </li>
            <li>Domain-based attacks (pharming attacks),
              in which the lookup of hostnames is altered to send users to a
              fraudulent server.
            </li>
            <li>Malicious code-based or trojan-based attacks,
                in which malicious software causes data compromises.
            </li>
          </ul>
          
        </pre>

        <section>
          <h1>Deceptive Phishing Attacks</h1>

          <pre>
            Several studies have shown <cite>visual_similarity_phishing_2008, why_phishing_works_06, suspectibility_to_phishing_2006</cite> that humans are especially vulnerable to visual deception. Dhamija et al. <cite>why_phishing_works_06</cite> provide empirical evidence about which phishing strategies are successful at deceiving average users. Their study shows that some visual deception attacks can fool even the most sophisticated users. In order to "design web browsers, websites and other tools to shield users from such attacks," it is necessary to "understand which attack strategies are successful, and what proportion of users they fool." <cite>why_phishing_works_06</cite>.

            The biggest nordic bank Nordea has been targeted several times for different phishing attacks. A typical method has been to send a message illustrated in figure <a href="#nordea_phishing_img_1" data-lattex="image-ref">XX</a> to thousands of recipients. Not all of the recipients are customers of the target service provider, but some are. And although not all of the customers will get fooled, some will. Because each fooled bank account holder means money for the attackers, targeted phishing can be lucrative criminal business.

            Phishing message in figure <a href="#nordea_phishing_img_2" data-lattex="image-ref">XX</a> includes an authentic looking link to the web bank and a request to go and fill all the one time passwords. The hyperlink is obfuscated: it does not lead where it is visibly pointing to. Instead the link leads to a phishing site illustrated in image <a href="#nordea_phishing_img_2" data-lattex="image-ref">XX</a> where the victim is supposed to fill in their unused passwords and all of the confirmation codes for Nordea's online banking <cite>nordea_fsecure_2006, nordea_miller_2006</cite>. The link also includes a unique identification code included in its URL which allows the attacker to identify the recipient. Because the sender can connect each identification code and email address, it is consequentially not necessary to ask for the customer's email address on the phishing site.
        
            <img src="images/nordea_phishing_email.jpg" 
                 id="nordea_phishing_img_1"
                 title="Phishing email targeted against Nordea customers in 2006"
                 alt="Example of a phishing email"
                 class="fit-width">
             
            <img src="images/nordea_phishing_website.png" 
                 id="nordea_phishing_img_2"
                 title="Phishing site asking for Nordea customers' e-bank accounts in the year 2006"
                 alt="Example of a phishing website"
                 class="fit-width">
          </pre>
        </section>
        <section>
          <h1>Deceptive Man-in-the-Middle Proxy</h1>
          <pre>
            Active phishing is more sophisticated and has a bigger potential for causing trouble than above examples of passive attacks. Instead of being disconnected from the authentic site, the phishing site could act as a man-in-the-middle proxy that communicate interactively with the site which it imitates. Successful man-in-the-middle could allow bypassing of all security measures protecting the authentication process <cite>beamauth_2factor_2007, schneier_2factor_2005, why_phishing_works_06</cite>: when the authentic site asks a challenge, the man-in-the-middle just delegates the question to the user. And when the user sends the response, it is delivered through the man-in-the-middle. As a result the transaction is compromised, because the original request can be altered without user's notice.

            Transport layer security (TLS) and secure sockets authentication (SSL) are designed to technically prevent man-in-the-middle vulnerabilities with certificates granted by a trusted third party. Nevertheless, the SSL/TLS secured communication can be compromised if the user does not arrive at the authentic site but is instead misguided to a visually deceptive man-in-the-middle phishing site. Studies <cite>why_phishing_works_06, suspectibility_to_phishing_2006</cite>[, CITE, CITE] show that users can't be protected using only a technical approach. For example, the Mozilla Security Reviewers' Guide <cite>mozilla_security_guide_2010</cite> states: "Many of our potential users are inexperienced computer users, who do not understand the risks involved in using interactive Web content. This means we must rely on the user's judgement as little as possible." User can, however, usually override the browser's protective measures.

            Study data of Downs <em>et al.</em> <cite>suspectibility_to_phishing_2006</cite> suggest that people can manage the risks that they are most familiar with, but don't appear to be wary of unfamiliar risks. Since lack of knowledge and attention is a considerable factor in being susceptible to phishing <cite>why_phishing_works_06</cite>, there exists a famous assertion regarding the correlation of dancing pigs and users' interest on security:

            <blockquote>
                "If J. Random Websurfer clicks on a button that promises dancing pigs on his computer monitor, and instead gets a hortatory message describing the potential dangers of the applet — he's going to choose dancing pigs over computer security any day. If the computer prompts him with a warning screen like: 'The applet DANCING PIGS could contain malicious code that might do permanent damage to your computer, steal your life's savings, and impair your ability to have children,' he'll click OK without even reading it. Thirty seconds later he won't even remember that the warning screen even existed." <cite>schneier_secrets_and_lies_2000</cite>
            </blockquote>

        </pre>
      </section> <!-- Deceptive -->
        
      <section>
        <h1>Lack of Knowledge and Attention</h1>
        <pre>
          Many users do not understand security indicators <cite>why_phishing_works_06</cite>. For example, many users do not know that a closed padlock icon in the browser indicates that the page they are viewing was secured by SSL. Studies of Dhamija <em>et al.</em> <cite>why_phishing_works_06</cite> show that even if users understand the meaning of the padlock icon, they can be fooled by its placement within the body of a webpage. Generally, users are not aware of the difference between the elements displayed in the browser's interface and the elements displayed in the page content area. The browser interface consists of e.g. toolbars, windows, address bar, and status bar that are constructed around the web page. The browser interface cannot be altered by a web page, thus, icons and notifications displayed in it should be trusted. On the contrary, icons and notifications displayed in the content of a web page can be placed there arbitrarily and should not be trusted.
          
          A surprising finding by Dhamija <em>et al.</em> <cite>why_phishing_works_06</cite> was that some users have erroneous knowledge and misconceptions about what website features indicate security. For example, "participants assumed that if websites contained professional-looking images, animations, and ads, they assumed the sites were legitimate." Similarly, dedicated login pages to bank services were less trusted than login form that was on the bank front page. For user convenience, some legitimate organizations allow users to login from non-SSL pages. Although the data may be transmitted securely (login form is submitted to an https url), the browser does not display a visual cue if SSL is used for form submission. As a workaround designers may place a padlock icon in the page content. Users who know to look for an SSL padlock icon may simply scan for the presence of it regardless of position, which is feasible for phishers since they can add a padlock in the phishing site too.
        </pre>  
      </section>
      
      <section>
        <h1>Examples of Security Ignorance</h1>
        <pre>
          In addition to understanding the security indicators of the browser, users lack of basic knowledge about how the web, email and applications work <cite>why_phishing_works_06</cite>. Phishing sites can exploit several aspects of this lack of knowledge. For example some users do not understand the syntax of domain names and can not distinguish an authentic web address from a fraudulent one. For example a user may think <em>ebay-members-security.com</em> belongs to <em>ebay.com</em>, address <em>www.nordea.com.sitemod.sess26xvwcwbcnnzoycvszh.blockerey.tw/confirm/portal.aspx/login</em> to <em>www.nordea.com</em> or that a URL <em>http://www.microsoft.com:login.asp@62.236.117.4</em> is originated from <em>www.microsoft.com</em> instead of <em>62.236.117.4</em>. Dhamija <em>et al.</em> <cite>why_phishing_works_06</cite> also found that "legitimate organizations further confused our participants by hosting secure pages with third parties, where the domain name does not match the brand name."
          
          Security is often a secondary goal <cite>why_phishing_works_06</cite>, even though security cannot be applied independently or afterwards <cite>schneier_secrets_and_lies_2000, lampson_distributed_1992</cite>. Even if users have the knowledge described above and can detect visual deception described in chapter [#REF], they may still be deceived if they fail to notice security indicators or the absence of them <cite>why_phishing_works_06</cite>. The Firefox browser shows several indicators for SSL protected pages, but there is no indicator for pages not protected by SSL. Many users do not notice the absence of an indicator and sometimes it is possible to insert a spoofed image of an indicator where one does not exist <cite>why_phishing_works_06</cite>.
          
          Dhamija <em>et al.</em> conclude <cite>why_phishing_works_06</cite> that "even in the best case scenario, when users expect spoofs to be present and are motivated to discover them, many users cannot distinguish a legitimate website from a spoofed website." Indicators whose sole purpose is to report on site's trustworthiness were not understood or noticed by many participants in the study <cite>why_phishing_works_06</cite>. 23% of the participants ignored all security indicators and cues in the browser's status bar and address bar. The study suggests that rather than trying to solve phishing related problems from a technical point of view, the user experience must be designed taking into account what humans do not do well. Dhamija <em>et al.</em> point out that security indicators should alert users of an untrusted state - in addition to have indicators appear under trusted conditions <cite>why_phishing_works_06</cite>. Ironically their study had just demonstrated that most users would simply dismiss such alerts.
          
        </pre>
      </section> <!-- Lack of K & A -->
      
      <section>
        <h1>Trojan-based Attacks</h1>
        
        <pre>
          "Game Over" could be used to describe getting infected by a trojan. 
          Uninvited code or a program executed without user's "actual" permission is called a trojan. The victim is usually asked if he wishes to install a particular program. As explained previously in the quote about dancing pigs [#REF: sivunumero] and studied in <cite>why_phishing_works_06</cite>, the victim usually does not bother reading any warnings.
          
          Very clever infiltrating methods have been found in the wild. One intriguing example is a malicious website which directly tells the visitor that it is a malicious website <cite>fsecure_webtrojan_2010</cite>. The site masquerades as a browser warning page and applies the correct layout and contents according to the victim's browser. The difference with the authentic page is that the malicious one offers a link to "download updates". The "update" contains a browser specific trojan. Although a confirmation action is required for the installation, the victim may happily agree with it and proceed with the installation as visualized in figure <a href="#firefox_reported_attack_page" data-lattex="image-ref"></a>. 

          <img src="images/firefox_reported_attack_page_trojan.png"
                id="firefox_reported_attack_page"
                alt="Imitated browser warning"
                title="Imitated warning offers to download a trojan as an &quot;update&quot;."
                class="fit-width" />

          <img src="images/firefox_reported_attack_page_authentic.png" 
                id="firefox_authentic_attack_page"
                alt="Authentic browser warning"
                title="Authentic browser warning does not offer anything to download."
                class="fit-width" />

          Beating the dancing pigs <cite>schneier_secrets_and_lies_2000</cite> seems to require either restrictive system administration, effective anti-virus software and software security education. Neither of them is in the scope of this thesis, hence, integrity of user's client software is left outside the scope of this thesis.

        </pre>
        
        
      </section> <!-- Trojans -->
      
      
    </section> <!-- Phishing Styles -->

      <section>
        <h1>Phishing Resistant Authentication Process</h1>
    
        <pre>
          A good solution against the web site phishing should be able to ensure the user's privacy, even if the user has sent such credentials to a falsified web server <cite>phishing_attacks_and_solutions_2007</cite>. In other words, even if the phishing site receives user's login credentials, they could not be re-used to log in to the legitimate system. Different kinds of schemes have been developed to achieve this, and in this paper we investigate possibilities of a two-factor authentication <cite>NIST_SP800-63, schneier_2factor_2005, google_2step_2010</cite>[CITE, CITE] on the application level.

        At the moment, the most popular and widely-deployed anti-phishing techniques are based on the use of blacklists <cite>visual_similarity_phishing_2008</cite>. These blacklists store a set of reported phishing domains. When the user visits a blacklisted domain, the browser displays a warning page and tries to prevent the user from visiting it. However, as described previously in chapter [#REF], this approach can also be vulnerable to visual deception.
        
        </pre>

      
        
      <section>
        <h1>Two-factor Authentication as an Additional Layer</h1>
      
        <pre>
          When challenge-response authentication is applied once, user is generally asked a password. A correct password is enough to complete the identification process. Two-factor authentication, also called as two-step verification, takes the process further. It provides the user with two challenges: first one depends on something that the user <em>knows</em> (a password) and second one on something that the user <em>has</em> (e.g. a phone number) <cite>NIST_SP800-63</cite>. The second factor can be formed by, for example, sending the user a verification code via an SMS message. To complete the authentication, the user must respond with a valid answer to both of the challenges.

          Schneier <cite>schneier_2factor_2005</cite> disagrees with the added security about two-step verification . He states that "it solves the security problems we had 10 years ago, not the security problems we have today." Let us think that an internet bank service, such as described in the previous chapter, sends a challenge to the user's phone number via an SMS message and expects a reply via SMS. If all bank customers are expected to have a cellphone, then this adds a two-factor authentication without extra hardware. The verification message is also transferred over another communications channel, which makes eavesdropping significantly more difficult.

          Nevertheless, according to Schneier <cite>schneier_2factor_2005</cite> [OISKO muitakin?] two-factor authentication does not increase security as a whole because the weakest link is elsewhere. "An attacker using a man-in-the-middle attack is happy to have the user deal with the SMS portion of the log-in, since he can’t do it himself." <cite>schneier_2factor_2005</cite> As explained in chapter [REF: edellinen kpl], if the user communicates with the authentic service having a man-in-the-middle, then two-factor authentication cannot help. The user can reply to all challenges proposed by the authentic bank, but he has no way of knowing that his request has been altered.

          Google rolled out two-step verification as a part of their Google Apps authentication process in September 2010 <cite>google_2step_2010</cite>. Google was cautious in their announcement which only promised to provide a "more secure" cloud authentication. They agree indirectly with Schneier <cite>schneier_2factor_2005</cite> by stating that the improvement helps only on stolen passwords. According to Schneier, two-factor authentication works within some corporate networks and for local log-in, but it won't work for remote authentication over the Internet <cite>schneier_2factor_2005</cite>. Implementing it as another layer of security will only result in a change of phishing strategies, because two-factor authentication mostly helps against passive eavesdropping, stolen passwords and offline password guessing.
        
        </pre>
        
      </section> <!-- Two-factor auth -->
      
      <section>
        <h1>Quality of OpenID Authentication</h1>
          <pre>
           While being agnostic about the person behind an identifier is sufficient in many use cases, it is not viable for all services. For example, using an OpenID identifier, which is authenticated only by password, to allow financial transacticions, such as a purchase with a credit card stored by the Relying Party, is not recommended <cite>yahoo_openid_bestpractices_2010</cite>. In such cases it is usually recommended to use an additional factor of authentication by the relying party before allowing the transaction be completed. 
         
           In order to automatically cope with different levels of trust in the authentication, OpenID specifies a provider authentication policy extension (PAPE) <cite>openid_2.0_specification_07, openid_2.0_pape_07</cite>. Employing PAPE allows a relying party to detect and decide whether the quality of an OpenID assertion is appropriate for a particular use case. The NIST Special Publication 800-63 <cite>NIST_SP800-63</cite>
          defines a set of Assurance Levels from 1 to 4 which may be used by identity provider in communication with the relying party. There exists also a level 0 which is used to signify that the identity provider has verified the owner of the OpenID identifier, but authentication did not meet the requirements of Level 1.
           
           For example Yahoo! OpenID assertions are marked as NIST Auth Level 0 to indicate that they "should not be used to authorize any transaction of value, including, but not limited to, financial transactions or accessing sensitive information, [..]" <cite>yahoo_openid_bestpractices_2010</cite>. In that case it is recommended that the relying party implement additional factors of authentication. However, this contradicts with the goal of delegating authentication procedures from the relying party to the identity provider.
           </pre> 
      </section> <!-- quality -->      
      
      <section>
        <h1>Extending the Security Level of OpenID Authentication</h1>
        <pre>
          Delegating the authentication to the identity provider as a whole has challenges. It implies that the relying party should not need to implement any additional authentication or handle stored credentials of its own. Relying party's ability of handling transactions of value poses a requirement for the identity provider: the OpenID assertion, when required, should qualify for a specific assurance level.

          OpenID Provider Authentication Policy Extension defines a schema for phishing-resistant authentication <cite>openid_2.0_pape_phishing_07</cite> which requires usage of a certificate in addition to a password. By implementing client certificates in an addition to the normal password challenge, the identity provider employs a two-factor authentication scheme. A successful authentication requires something that you know (password) and something that you have (certificate). 

          <img src="images/openid_authentication_policy_examples.jpg" 
               style="width: 90%"
               title="Examples of common authentication technologies and their mapping to the Authentication Policies defined in <cite>openid_2.0_pape_phishing_07</cite> (Section 4)."></img>
          
          Due to the nature of asymmetric encryption, certificates also eliminate the risk of the user accidentally giving his credentials to a fraudulent site. The private component of the user's certificate is stored in user's browser and is never sent on the communications channel. Capturing user's credentials would require the user deliberately send the private key file to an attacker or compromise the user's software security. However, as explained in chapter [#REF trojans], integrity of user's software is out of our scope. 
          
          Having one identity provider providing the public component for the certificate for multiple services is also a convenience for the user. Whenever the user wants to change his certificate, e.g. the old one expires, he needs to update the public component only for the identity provider. This has an advantage over the relying party storing anything: if a relying party had a credential storage of its own, the public component of the certificate would need to be individually updated to each.

          Not every relying party needs a PAPE security assertion, that is, a higher security level can be required on demand. This proposes two options: Either the relying party requires a certain security level during authentication, or it first accepts a PAPE level 0 and does not require additional credentials until the user begins a transaction of value. This enables a flexible scheme: the user may sign in everywhere using the same OpenID identifier authenticated only by password. However, when there is a need, for example, to use a previously stored credit card, the user is first redirected to the identity provider in order to enhance the PAPE security level.
        </pre>
          
          
      </section> <!-- comb openid & cc -->
      

      
    </section> <!-- Phishing Solutions -->


    <section>
      <h1>Conclusions</h1>
      
      <pre>
        This paper explained severe phishing risks for online authentication. Understanding the problems of basic challenge-response authentication helps us to understand the requirements for extended security procedures. We presented that using a combination of OpenID and client certificate has benefits for both the users and the developers. 
        
        Usage of client certificate could allow users to achieve a phishing resistant authentication. Because the communication channel never carries the private key component of a certificate, user cannot mistakenly submit his credentials to a fraudulent site. 
        
        Secondly, since OpenID provides a standardized authentication protocol for which several mature libraries exists. The details regarding the handling of certificates and authentication are outsourced to the identity provider. Hence, the service developers of the relying party need to apply only one authentication procedure. It is enough for relying party to trust the PAPE security level given by the identity provider.
        <ul>
          <li>X not everything transferred on the wire: asynchronous authentication keys</li>
          <!-- <li>user-centric identity &amp; single sign-on: pros and cons</li> -->
          <li>no technical solution for deceptive attacks: educate users</li>
          <li>eri tasoinen auth eri palveluihin tai sessioihin, mutta sama idp (SELITÄ LISÄKSI: directed identity)</li>
          <li>salasanakompromissi: salasana = heikoin lenkki -> keskitetään</li>
          <li>jos PAPE-taso ei riitä, ohjataan idp:lle lisätunnistamista varten (cert, tekstiviesti, kertakäyttötunnukset whatever)</li>
          <!-- <li>olet palveluntarjoajana armoilla: jos openid-tunnus muuttuu, et pääse sisään.</li>
          <li>onelogin: ei openid-vaan connectorit pilvipalvelussa</li> -->
          <li>tehdäänkö tässä uudelleen federoitu identiteetti? ei, koska rp:n ei tarvitse tuntea idp:tä etukäteen. idp takaa ainoastaan sen, että yhtä openid-tunnistetta voi käyttää vain yksi käyttäjä (who cannot be impersonated).</li>
          <li>porblem: sisäänkirjautuminen julkisella koneella</li>
          <!-- sometimes even experienced users fail to notice a scam, tupla-v bankofthevvest.com -->
          <!-- Ei voida luottaa kenen tahansa määrittelemään PAPE-luokitukseen, 
              pitää luottaa ensin tarjoajaan, 
              vasta sen jälkeen voi luottaa tarjoajan kertomaan luokitukseen. -->
          
        </ul>
      </pre>
      
    </section>
    
    
      
    </article>

    <!-- TODO: Semmapaperissa ei viitata näihin kaikkiin lähteisiin -->
    
    <article class="references">
      <h1>References</h1>
      <dl>
        <dt data-lattex="phishing_attacks_and_solutions_2007">Moh07</dt>
        <dd>
          B. Mohamad, I. Hajjeh, and S. El Sawda, "Phishing Attacks and Solutions," Proceedings of the Third International Mobile Multimedia Communications Conference, 2007.
        </dd>

        <dt data-lattex="why_phishing_works_06">Dha06</dt>
        <dd>
          R. Dhamija, J.D. Tygar, and M. Hearst, "Why phishing works," Proceedings of the SIGCHI conference on Human Factors in computing systems - CHI '06, 2006, p. 581.
        </dd>

        <dt data-lattex="suspectibility_to_phishing_2006">Dow06</dt>
        <dd>
          J.S. Downs, M.B. Holbrook, and L.F. Cranor, "Decision strategies and susceptibility to phishing," Proceedings of the second symposium on Usable privacy and security - SOUPS '06, vol. 15213, 2006, p. 79.
        </dd>

        <dt data-lattex="visual_similarity_phishing_2008">Med08</dt>
        <dd>
          E. Medvet, E. Kirda, and C. Kruegel, "Visual-similarity-based phishing detection," Proceedings of the 4th international conference on Security and privacy in communication netowrks - SecureComm '08, 2008, p. 1.
        </dd>

        <dt data-lattex="schneier_2factor_2005">Sch05</dt>
        <dd>
          B. Schneier, "Two-Factor Authentication: Too Little, Too Late," Communications of the ACM, 2005, pp. 136-136.
        </dd>

        <dt data-lattex="beamauth_2factor_2007">Adi07</dt>
        <dd>
          Adida B. BeamAuth : Two-Factor Web Authentication with a Bookmark. Applied Sciences. 2007:48-57. Available at: http://portal.acm.org/citation.cfm?doid=1315245.1315253.
        </dd>
        
        <dt data-lattex="schneier_secrets_and_lies_2000">Sch05</dt>
        <dd>
          B. Schneier: Secrets and Lies (John Wiley &amp; Sons, 2000; ISBN 0-471-45380-3), p262
        </dd>
        
        <dt data-lattex="phishing_attacks_and_solutions_2007">Moh07</dt>
        <dd>
          B. Mohamad, I. Hajjeh, and S. El Sawda, Phishing Attacks and Solutions, Proceedings of the Third International Mobile Multimedia Communications Conference, 2007.
        </dd>
        
        <dt data-lattex="foafssl_henrystory">Sto0?</dt>
        <dd>
          H. Story, B. Harbulot, I. Jacobi, and M. Jones, FOAF + SSL : RESTful Authentication for the Social Web, TODO: Lähteen detailit
        </dd>
        
        <dt data-lattex="lampson_distributed_1992">Lam92</dt>
        <dd>
          B. Lampson, M. Abadi, M. Burrows, and E. Wobber, "Authentication in distributed systems: theory and practice," ACM Transactions on Computer Systems, vol. 10, 1992, pp. 265-310.
        </dd>

        <dt data-lattex="iso_cia">ISO89</dt>
        <dd>
          ISO 7498-2 Information Processing Systems - Open Systems Interconnection - Basic Reference Model - Part 2: Security Architecture. ISO/IEC 1989
        </dd>

        <dt data-lattex="open_identity_management_saas_2009">Bin09</dt>
        <dd>
          W. Bin, H.H. Yuan, L.X. Xi, and X.J. Min, "Open Identity Management Framework for SaaS Ecosystem," 2009 IEEE International Conference on e-Business Engineering, 2009, pp. 512-517.
        </dd>
        
        
        <dt data-lattex="openid_2.0_platform_2009">Rec09</dt>
        <dd>
          D. Recordon and D. Reed, "OpenID 2 . 0 : A Platform for User-Centric Identity Management," 2006, pp. 11-15.
        </dd>
        
        <dt data-lattex="NIST_SP800-63">NIST06</dt>
        <dd>
          Special Publication 800-63 (Burr, W., Dodson, D., and W. Polk, Ed., “Electronic Authentication Guideline,” April 2006. http://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html#NIST_SP800-63
        </dd>

        <!--
        <dt data-lattex=""></dt>
        <dd>
          
        </dd>
        -->


        <!-- WIKIPEDIA -->
        <dt data-lattex="wikipedia:Challenge-response_authentication">Wik10a</dt>
        <dd>
          http://en.wikipedia.org/wiki/Challenge-response_authentication
        </dd>

        <dt data-lattex="wikipedia_authentication">Wik10b</dt>
        <dd>
          http://en.wikipedia.org/wiki/Authentication
        </dd>

        <dt data-lattex="wikipedia_authorization">Wik10c</dt>
        <dd>
          http://en.wikipedia.org/wiki/Authorization
        </dd>

        <!-- WEBISSÄ JULKAISTUT DOKUMENTIT -->
        <dt data-lattex="pharming_guide_2005">Oll05</dt>
        <dd>
          Ollmann G. The Pharming Guide. Security.1-37. Available at: http://www.ngssoftware.com/papers/ThePharmingGuide.pdf.
        </dd>
        
        
        <!-- WEBSIVUT -->
        <dt data-lattex="openid_year2009">Web09a</dt>
        <dd>
          http://openid.net/2009/12/16/openid-2009-year-in-review/
        </dd>
        
        <dt data-lattex="nordea_fsecure_2006">WebX06a</dt>
        <dd>
          Website: F-Secure blog post about Nordea phishing, http://www.f-secure.com/weblog/archives/00000849.html
        </dd>

        <dt data-lattex="nordea_miller_2006">WebX06b</dt>
        <dd>
          Website: Scam Report on Nordea phishing http://www.millersmiles.co.uk/report/2464
        </dd>
        
        <dt data-lattex="google_2step_2010">WebX10a</dt>
        <dd>
          Website: A more secure cloud for millions of Google Apps users http://googleenterprise.blogspot.com/2010/09/more-secure-cloud-for-millions-of.html
        </dd>
        
        <dt data-lattex="mozilla_security_guide_2010">WebX10b</dt>
        <dd>
          Website: Mozilla Security Review and Best Practices Guide, http://www.mozilla.org/projects/security/components/reviewguide.html
        </dd>
        
        <dt data-lattex="fsecure_webtrojan_2010">WebX10c</dt>
        <dd>
          Website: F-Secure blog post 20. Oct. 2010 about web trojans,
          http://www.f-secure.com/weblog/archives/00002051.html
        </dd>

        <dt data-lattex="yahoo_openid_bestpractices_2010">WebX10d</dt>
        <dd>
          Yahoo! OpenID Best Practices,
          http://developer.yahoo.com/openid/faq.html
        </dd>

        <dt data-lattex="openid_2.0_specification_07">Ope07a</dt>
        <dd>
          OpenID 2.0 Specifiacation
          http://openid.net/specs/openid-authentication-2_0.html
        </dd>

        <dt data-lattex="openid_2.0_pape_07">Ope07b</dt>
        <dd>
          OpenID Provider Authentication Policy Extension 1.0
          http://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html
        </dd>

        <dt data-lattex="openid_2.0_pape_phishing_07">Ope07c</dt>
        <dd>
          Phishing Resistant Authentication Scheme, OpenID Provider Authentication Policy Extension 1.0
          http://openid.net/specs/openid-provider-authentication-policy-extension-1_0.html#rfc.section.4
        </dd>


        <dt data-lattex="xri_depcrecated_08d">XRI08d</dt>
        <dd>
          Mary P McRae, Manager of TC Administration, OASIS,
          http://lists.oasis-open.org/archives/xri/200806/msg00001.html
        </dd>
        
        <dt data-lattex="xri_depcrecated_08c">XRI08c</dt>
        <dd>
          Tim Berners-Lee and Stuart Williams, co-chairs, W3C Technical Architecture Group,
          Mailing List, TAG recommends against XRI,
          http://lists.w3.org/Archives/Public/www-tag/2008May/0078.html
        </dd>

        <dt data-lattex="xri_depcrecated_08b">XRI08b</dt>
        <dd>
          OASIS Ballot Results (with enough negative votes), Approve XRI Syntax v2.0 as an OASIS Standard,
          http://www.oasis-open.org/committees/ballot.php?id=1470
        </dd>

        <dt data-lattex="xri_depcrecated_08a">XRI08a</dt>
        <dd>
          OASIS Ballot Results (with enough negative votes), Approve XRI Resolution v2.0 as an OASIS Standard,
          http://www.oasis-open.org/committees/ballot.php?id=1468
        </dd>



        

      </dl>
          
    </article>

    <footer>
      <span data-lattex="pagenumber"></span>  <span>&copy; pottisheads</span>
    </footer>
    

  </body>

</html>
